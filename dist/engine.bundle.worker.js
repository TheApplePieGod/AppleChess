(()=>{var e={590:(e,t)=>{"use strict";var i,s,r,a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.kingEndGameSquareTable=t.kingMiddleGameSquareTable=t.queenSquareTable=t.rookSquareTable=t.bishopSquareTable=t.knightSquareTable=t.pawnSquareTable=t.indexToNotation=t.notationToIndex=t.getPieceNameShort=t.getPieceName=t.Sounds=t.EvalCommands=t.EngineCommands=t.Value=t.Piece=void 0,function(e){e[e.Empty=0]="Empty",e[e.King_B=1]="King_B",e[e.Queen_B=2]="Queen_B",e[e.Rook_B=3]="Rook_B",e[e.Bishop_B=4]="Bishop_B",e[e.Knight_B=5]="Knight_B",e[e.Pawn_B=6]="Pawn_B",e[e.King_W=7]="King_W",e[e.Queen_W=8]="Queen_W",e[e.Rook_W=9]="Rook_W",e[e.Bishop_W=10]="Bishop_W",e[e.Knight_W=11]="Knight_W",e[e.Pawn_W=12]="Pawn_W"}(i=t.Piece||(t.Piece={})),(o=t.Value||(t.Value={}))[o.Pawn=100]="Pawn",o[o.Knight=300]="Knight",o[o.Bishop=300]="Bishop",o[o.Rook=500]="Rook",o[o.Queen=900]="Queen",(a=t.EngineCommands||(t.EngineCommands={}))[a.None=0]="None",a[a.RetrieveBoard=1]="RetrieveBoard",a[a.AttemptMove=2]="AttemptMove",a[a.HistoryGoBack=3]="HistoryGoBack",a[a.HistoryGoForward=4]="HistoryGoForward",a[a.BotBestMove=5]="BotBestMove",a[a.BotBestMoveIterative=6]="BotBestMoveIterative",a[a.RetrievePieceLocations=7]="RetrievePieceLocations",a[a.ReceiveCurrentEval=8]="ReceiveCurrentEval",a[a.UpdateEval=9]="UpdateEval",a[a.UndoMove=10]="UndoMove",(r=t.EvalCommands||(t.EvalCommands={}))[r.ReceiveCurrentEval=0]="ReceiveCurrentEval",r[r.UpdateState=1]="UpdateState",r[r.Evaluate=2]="Evaluate",(s=t.Sounds||(t.Sounds={}))[s.None=0]="None",s[s.PieceMoved=1]="PieceMoved",s[s.PieceCaptured=2]="PieceCaptured",s[s.Checked=3]="Checked",s[s.Castled=4]="Castled",s[s.IllegalMove=5]="IllegalMove",s[s.GameOver=6]="GameOver",s[s.PieceMoved2=7]="PieceMoved2",t.getPieceName=e=>{switch(e){case i.Pawn_W:case i.Pawn_B:return"Pawn";case i.Knight_W:case i.Knight_B:return"Knight";case i.Bishop_W:case i.Bishop_B:return"Bishop";case i.Rook_W:case i.Rook_B:return"Rook";case i.Queen_W:case i.Queen_B:return"Queen";case i.King_W:case i.King_B:return"King";default:return""}},t.getPieceNameShort=e=>{switch(e){case i.Pawn_W:case i.Pawn_B:return"";case i.Knight_W:return"N";case i.Knight_B:return"n";case i.Bishop_W:return"B";case i.Bishop_B:return"b";case i.Rook_W:return"R";case i.Rook_B:return"r";case i.Queen_W:return"Q";case i.Queen_B:return"q";case i.King_W:return"K";case i.King_B:return"k";default:return""}},t.notationToIndex=(e,t)=>8*(8-e)+(t.charCodeAt(0)-97),t.indexToNotation=e=>{const t=Math.floor(e/8),i=e%8;return`${String.fromCharCode(i+97)}${8-t}`},t.pawnSquareTable=[0,0,0,0,0,0,0,0,50,50,50,50,50,50,50,50,10,10,20,30,30,20,10,10,5,5,10,25,25,10,5,5,0,0,0,20,20,0,0,0,5,-5,-10,0,0,-10,-5,5,5,10,10,-20,-20,10,10,5,0,0,0,0,0,0,0,0],t.knightSquareTable=[-50,-40,-30,-30,-30,-30,-40,-50,-40,-20,0,0,0,0,-20,-40,-30,0,10,15,15,10,0,-30,-30,5,15,20,20,15,5,-30,-30,0,15,20,20,15,0,-30,-30,5,10,15,15,10,5,-30,-40,-20,0,5,5,0,-20,-40,-50,-40,-30,-30,-30,-30,-40,-50],t.bishopSquareTable=[-20,-10,-10,-10,-10,-10,-10,-20,-10,0,0,0,0,0,0,-10,-10,0,5,10,10,5,0,-10,-10,5,5,10,10,5,5,-10,-10,0,10,10,10,10,0,-10,-10,10,10,10,10,10,10,-10,-10,5,0,0,0,0,5,-10,-20,-10,-10,-10,-10,-10,-10,-20],t.rookSquareTable=[0,0,0,0,0,0,0,0,5,10,10,10,10,10,10,5,-5,0,0,0,0,0,0,-5,-5,0,0,0,0,0,0,-5,-5,0,0,0,0,0,0,-5,-5,0,0,0,0,0,0,-5,-5,0,0,0,0,0,0,-5,0,0,0,5,5,0,0,0],t.queenSquareTable=[-20,-10,-10,-5,-5,-10,-10,-20,-10,0,0,0,0,0,0,-10,-10,0,5,5,5,5,0,-10,-5,0,5,5,5,5,0,-5,0,0,5,5,5,5,0,-5,-10,5,5,5,5,5,0,-10,-10,0,5,0,0,0,0,-10,-20,-10,-10,-5,-5,-10,-10,-20],t.kingMiddleGameSquareTable=[-30,-40,-40,-50,-50,-40,-40,-30,-30,-40,-40,-50,-50,-40,-40,-30,-30,-40,-40,-50,-50,-40,-40,-30,-30,-40,-40,-50,-50,-40,-40,-30,-20,-30,-30,-40,-40,-30,-30,-20,-10,-20,-20,-20,-20,-20,-20,-10,20,20,0,0,0,0,20,20,20,30,10,0,0,10,30,20],t.kingEndGameSquareTable=[-50,-40,-30,-20,-20,-30,-40,-50,-30,-20,-10,0,0,-10,-20,-30,-30,-10,20,30,30,20,-10,-30,-30,-10,30,40,40,30,-10,-30,-30,-10,30,40,40,30,-10,-30,-30,-10,20,30,30,20,-10,-30,-30,-30,0,0,0,0,-30,-30,-50,-30,-30,-30,-30,-30,-30,-50]},212:function(e,t,i){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Engine=void 0;const r=s(i(736)),a=i(590),o=self;var n,h;!function(e){e[e.Exact=0]="Exact",e[e.Alpha=1]="Alpha",e[e.Beta=2]="Beta"}(n||(n={})),function(e){e[e.WhiteKing=1]="WhiteKing",e[e.WhiteQueen=2]="WhiteQueen",e[e.BlackKing=4]="BlackKing",e[e.BlackQueen=8]="BlackQueen"}(h||(h={}));class u{constructor(){this.boardSize=8,this.board=[],this.boardDelta=[],this.boardHash=BigInt(0),this.zobristHashTable=[],this.savedEvaluations={},this.evalBestMove={from:-1,to:-1,data:0,score:0},this.evalBestMoveThisIteration={from:-1,to:-1,data:0,score:0},this.movesFoundThisTurn=[],this.movesFoundThisIteration=[],this.repetitionHistory=[],this.searchStartTime=0,this.searchMaxTime=3e3,this.pieceCapturedThisTurn=!1,this.castledThisTurn=!1,this.timeTakenLastTurn=0,this.depthSearchedThisTurn=0,this.pieceLocations=[[],[],[],[],[],[],[],[],[],[],[],[],[]],this.moveCount=0,this.moveRepCount=0,this.pinnedPieces=[],this.historicalBoards=[],this.historicalIndex=0,this.whiteTurn=!0,this.castleStatus=0,this.enPassantSquare=-1,this.allValidMoves=[],this.fenToPieceDict={K:a.Piece.King_W,Q:a.Piece.Queen_W,R:a.Piece.Rook_W,B:a.Piece.Bishop_W,N:a.Piece.Knight_W,P:a.Piece.Pawn_W,k:a.Piece.King_B,q:a.Piece.Queen_B,r:a.Piece.Rook_B,b:a.Piece.Bishop_B,n:a.Piece.Knight_B,p:a.Piece.Pawn_B},this.startingMaterialWithoutPawns=2*a.Value.Bishop+2*a.Value.Knight+2*a.Value.Rook+a.Value.Queen,this.startingMaterial=8*a.Value.Pawn+this.startingMaterialWithoutPawns,this.endgameMaterialThreshold=2*a.Value.Rook+a.Value.Bishop+a.Value.Knight,this.createHistoricalBoard=()=>{let e=[...this.pieceLocations];for(let t=0;t<e.length;t++)e[t]=[...e[t]];return{board:[...this.board],whiteTurn:this.whiteTurn,castleStatus:this.castleStatus,pieceLocations:e,moveCount:this.moveCount,moveRepCount:this.moveRepCount,repetitionHistory:[...this.repetitionHistory]}},this.useHistoricalBoard=e=>{this.board=[...e.board],this.whiteTurn=e.whiteTurn,this.castleStatus=e.castleStatus,this.pieceLocations=[...e.pieceLocations];for(let e=0;e<this.pieceLocations.length;e++)this.pieceLocations[e]=[...this.pieceLocations[e]];this.moveCount=e.moveCount,this.moveRepCount=e.moveRepCount,this.repetitionHistory=[...e.repetitionHistory],this.boardHash=this.hashBoard(),this.savedEvaluations={},this.evalBestMove={},this.movesFoundThisTurn=[],this.allValidMoves=this.getAllValidMoves()},this.stepBack=()=>{if(Math.abs(this.historicalIndex)<this.historicalBoards.length-1){this.historicalIndex--;const e=this.historicalBoards[this.historicalBoards.length-1+this.historicalIndex];this.useHistoricalBoard(e)}},this.stepForward=()=>{if(this.historicalIndex<0){this.historicalIndex++;const e=this.historicalBoards[this.historicalBoards.length-1+this.historicalIndex];this.useHistoricalBoard(e)}},this.undoMove=()=>{if(this.historicalBoards.length>1&&0==this.historicalIndex){this.historicalIndex=0;const e=this.historicalBoards[this.historicalBoards.length-2];this.useHistoricalBoard(e),this.historicalBoards.pop()}},this.hashBoard=()=>{let e=BigInt(0);for(let t=0;t<this.board.length;t++)if(this.board[t]!=a.Piece.Empty){const i=this.board[t]-1;e^=this.zobristHashTable[t][i]}return this.castleStatus&h.WhiteKing&&(e^=this.zobristHashTable[64][0]),this.castleStatus&h.WhiteQueen&&(e^=this.zobristHashTable[64][1]),this.castleStatus&h.BlackKing&&(e^=this.zobristHashTable[64][2]),this.castleStatus&h.BlackQueen&&(e^=this.zobristHashTable[64][3]),this.whiteTurn&&(e^=this.zobristHashTable[65][0]),-1!=this.enPassantSquare&&(e^=this.zobristHashTable[66][this.enPassantSquare]),e},this.parseFEN=e=>{let t=[];for(let e=0;e<this.boardSize*this.boardSize;e++)t.push(a.Piece.Empty);const i=e.split(" "),s=i[0].split("/");let r=0;for(let e=0;e<s.length;e++){const i=s[e].split("");for(let e=0;e<i.length;e++){const s=parseInt(i[e]);if(isNaN(s)){const s=this.fenToPieceDict[i[e]];t[r]=s,this.pieceLocations[s].push(r),r++}else r+=s}}return this.whiteTurn="w"==i[1],this.castleStatus=0,i[2].includes("K")&&(this.castleStatus|=h.WhiteKing),i[2].includes("Q")&&(this.castleStatus|=h.WhiteQueen),i[2].includes("k")&&(this.castleStatus|=h.BlackKing),i[2].includes("q")&&(this.castleStatus|=h.BlackQueen),"-"!=i[3]&&(this.enPassantSquare=a.notationToIndex(parseInt(i[3][1]),i[3][0])),this.moveRepCount=parseInt(i[4]),this.moveCount=2*parseInt(i[5])-2,t},this.traceValidSquares=(e,t,i,s,r,o,n)=>{let h=e;const u=this.boardSize-1,c=this.board.length;let l=!1,p=0;for(;h>=0&&h<c;){if(h!=e)if(l){if(!o)break;if(this.board[h]!=a.Piece.King_W&&this.board[h]!=a.Piece.King_B&&this.board[h]!=a.Piece.Empty)break;if(s&&this.board[h]==a.Piece.King_B&&this.board[p]<7){this.pinnedPieces.push(p);break}if(!s&&this.board[h]==a.Piece.King_W&&this.board[p]>=7){this.pinnedPieces.push(p);break}}else{if(r){if(this.board[h]!=a.Piece.Empty)break;n.push(h)}else(this.board[h]==a.Piece.Empty||s&&this.board[h]<7||!s&&this.board[h]>=7)&&n.push(h);l=this.board[h]!=a.Piece.Empty,p=h}const c=h%this.boardSize,d=Math.floor(h/this.boardSize);if(-1==t&&0==c)break;if(1==t&&c==u)break;if(-1==i&&0==d)break;if(1==i&&d==u)break;h+=t+i*this.boardSize}},this.getValidSquares=(e,t,i,s,r)=>{const o=e%this.boardSize,n=Math.floor(e/this.boardSize),h=this.boardSize-1,u=t>=7;switch(t){case a.Piece.Rook_W:case a.Piece.Rook_B:this.traceValidSquares(e,1,0,u,!1,s,r),this.traceValidSquares(e,-1,0,u,!1,s,r),this.traceValidSquares(e,0,1,u,!1,s,r),this.traceValidSquares(e,0,-1,u,!1,s,r);break;case a.Piece.Queen_W:case a.Piece.Queen_B:this.traceValidSquares(e,1,0,u,!1,s,r),this.traceValidSquares(e,-1,0,u,!1,s,r),this.traceValidSquares(e,0,1,u,!1,s,r),this.traceValidSquares(e,0,-1,u,!1,s,r),this.traceValidSquares(e,1,-1,u,!1,s,r),this.traceValidSquares(e,-1,-1,u,!1,s,r),this.traceValidSquares(e,1,1,u,!1,s,r),this.traceValidSquares(e,-1,1,u,!1,s,r);break;case a.Piece.Bishop_W:case a.Piece.Bishop_B:this.traceValidSquares(e,1,-1,u,!1,s,r),this.traceValidSquares(e,-1,-1,u,!1,s,r),this.traceValidSquares(e,1,1,u,!1,s,r),this.traceValidSquares(e,-1,1,u,!1,s,r);break;case a.Piece.Pawn_W:{const t=e-this.boardSize,s=e-2*this.boardSize,u=t-1,c=t+1;i||(t>=0&&this.board[t]==a.Piece.Empty&&r.push(t),6==n&&this.board[s]==a.Piece.Empty&&this.board[t]==a.Piece.Empty&&r.push(s)),0!=o&&u>=0&&(this.board[u]!=a.Piece.Empty||u==this.enPassantSquare||i)&&(this.board[u]<7||u==this.enPassantSquare)&&r.push(u),o!=h&&c>=0&&(this.board[c]!=a.Piece.Empty||c==this.enPassantSquare||i)&&(this.board[c]<7||c==this.enPassantSquare)&&r.push(c);break}case a.Piece.Pawn_B:{const t=e+this.boardSize,s=e+2*this.boardSize,u=t-1,c=t+1;i||(t<this.board.length&&this.board[t]==a.Piece.Empty&&r.push(t),1==n&&this.board[s]==a.Piece.Empty&&this.board[t]==a.Piece.Empty&&r.push(s)),0!=o&&u<this.board.length&&(this.board[u]!=a.Piece.Empty||u==this.enPassantSquare||i)&&(this.board[u]>=7||this.board[u]==a.Piece.Empty||u==this.enPassantSquare)&&r.push(u),o!=h&&c<this.board.length&&(this.board[c]!=a.Piece.Empty||c==this.enPassantSquare||i)&&(this.board[c]>=7||this.board[c]==a.Piece.Empty||c==this.enPassantSquare)&&r.push(c);break}case a.Piece.King_W:case a.Piece.King_B:{const t=e-this.boardSize,i=e+this.boardSize,s=e-1,n=e+1,c=t-1,l=t+1,p=i-1,d=i+1;t>=0&&(this.board[t]==a.Piece.Empty||u&&this.board[t]<7||!u&&this.board[t]>=7)&&r.push(t),i<this.board.length&&(this.board[i]==a.Piece.Empty||u&&this.board[i]<7||!u&&this.board[i]>=7)&&r.push(i),0!=o&&s>=0&&(this.board[s]==a.Piece.Empty||u&&this.board[s]<7||!u&&this.board[s]>=7)&&r.push(s),o!=h&&n<this.board.length&&(this.board[n]==a.Piece.Empty||u&&this.board[n]<7||!u&&this.board[n]>=7)&&r.push(n),0!=o&&c>=0&&(this.board[c]==a.Piece.Empty||u&&this.board[c]<7||!u&&this.board[c]>=7)&&r.push(c),o!=h&&l>=0&&(this.board[l]==a.Piece.Empty||u&&this.board[l]<7||!u&&this.board[l]>=7)&&r.push(l),0!=o&&p<this.board.length&&(this.board[p]==a.Piece.Empty||u&&this.board[p]<7||!u&&this.board[p]>=7)&&r.push(p),o!=h&&d<this.board.length&&(this.board[d]==a.Piece.Empty||u&&this.board[d]<7||!u&&this.board[d]>=7)&&r.push(d);break}case a.Piece.Knight_W:case a.Piece.Knight_B:{const t=e-this.boardSize-2,i=e-2*this.boardSize-1,s=e-2*this.boardSize+1,c=e-this.boardSize+2,l=e+this.boardSize-2,p=e+2*this.boardSize-1,d=e+2*this.boardSize+1,v=e+this.boardSize+2;o>=2&&n>=1&&(this.board[t]==a.Piece.Empty||u&&this.board[t]<7||!u&&this.board[t]>=7)&&r.push(t),o>=1&&n>=2&&(this.board[i]==a.Piece.Empty||u&&this.board[i]<7||!u&&this.board[i]>=7)&&r.push(i),o<=h-1&&n>=2&&(this.board[s]==a.Piece.Empty||u&&this.board[s]<7||!u&&this.board[s]>=7)&&r.push(s),o<=h-2&&n>=1&&(this.board[c]==a.Piece.Empty||u&&this.board[c]<7||!u&&this.board[c]>=7)&&r.push(c),o>=2&&n<=h-1&&(this.board[l]==a.Piece.Empty||u&&this.board[l]<7||!u&&this.board[l]>=7)&&r.push(l),o>=1&&n<=h-2&&(this.board[p]==a.Piece.Empty||u&&this.board[p]<7||!u&&this.board[p]>=7)&&r.push(p),o<=h-1&&n<=h-2&&(this.board[d]==a.Piece.Empty||u&&this.board[d]<7||!u&&this.board[d]>=7)&&r.push(d),o<=h-2&&n<=h-1&&(this.board[v]==a.Piece.Empty||u&&this.board[v]<7||!u&&this.board[v]>=7)&&r.push(v);break}}},this.getAttackedSquares=(e,t)=>{let i=[];const s=e?6:12;for(let r=e?1:7;r<=s;r++){const e=this.pieceLocations[r].length;for(let s=0;s<e;s++)this.pieceLocations[r][s]!=t&&this.getValidSquares(this.pieceLocations[r][s],r,!0,!1,i)}return i},this.updatePinnedSquares=e=>{let t=[];const i=e?4:10;for(let s=e?2:8;s<=i;s++){const e=this.pieceLocations[s].length;for(let i=0;i<e;i++)this.getValidSquares(this.pieceLocations[s][i],s,!0,!0,t)}},this.getValidCastleSquares=(e,t)=>{if(this.whiteTurn){let i=[];this.traceValidSquares(60,1,0,!1,!0,!1,i),this.castleStatus&h.WhiteKing&&this.board[63]==a.Piece.Rook_W&&2==i.length&&(e.includes(60)||e.includes(61)||e.includes(62)||t.push({from:60,to:62,data:0,score:0})),i=[],this.traceValidSquares(60,-1,0,!1,!0,!1,i),this.castleStatus&h.WhiteQueen&&this.board[56]==a.Piece.Rook_W&&3==i.length&&(e.includes(60)||e.includes(59)||e.includes(58)||t.push({from:60,to:58,data:0,score:0}))}else{let i=[];this.traceValidSquares(4,1,0,!1,!0,!1,i),this.castleStatus&h.BlackKing&&this.board[7]==a.Piece.Rook_B&&2==i.length&&(e.includes(4)||e.includes(5)||e.includes(6)||t.push({from:4,to:6,data:0,score:0})),i=[],this.traceValidSquares(4,-1,0,!1,!0,!1,i),this.castleStatus&h.BlackQueen&&this.board[0]==a.Piece.Rook_B&&3==i.length&&(e.includes(4)||e.includes(3)||e.includes(2)||t.push({from:4,to:2,data:0,score:0}))}},this.isInCheck=e=>{const t=this.getAttackedSquares(e,-1);return this.isInCheckAttackedSquares(e,t)},this.isInCheckAttackedSquares=(e,t)=>e&&t.includes(this.pieceLocations[a.Piece.King_W][0])||!e&&t.includes(this.pieceLocations[a.Piece.King_B][0]),this.getAllValidMoves=(e=!1,t=[])=>{let i=[];0==t.length&&(t=this.getAttackedSquares(this.whiteTurn,-1)),e||this.getValidCastleSquares(t,i),this.pinnedPieces=[],this.updatePinnedSquares(this.whiteTurn);const s=this.isInCheckAttackedSquares(this.whiteTurn,t),r=this.whiteTurn?7:1,o=this.whiteTurn?12:6;for(let t=r;t<=o;t++){const r=this.pieceLocations[t].length;for(let o=0;o<r;o++){const r=this.pieceLocations[t][o];let n=[];this.getValidSquares(r,t,e,!1,n);const h=this.pinnedPieces.includes(r),u=n.length;for(let o=0;o<u;o++){if(e&&this.board[n[o]]==a.Piece.Empty)continue;if(s||h||t==a.Piece.King_W||t==a.Piece.King_B){const e=this.board[n[o]],i=this.board[r];this.board[n[o]]=t,this.board[r]=a.Piece.Empty;const s=this.getAttackedSquares(this.whiteTurn,n[o]);if(this.board[n[o]]=e,this.board[r]=i,t==a.Piece.King_W||t==a.Piece.King_B){if(s.includes(n[o]))continue}else if(this.isInCheckAttackedSquares(this.whiteTurn,s))continue}const u=Math.floor(n[o]/this.boardSize);t==a.Piece.Pawn_W&&0==u?(i.push({from:r,to:n[o],data:a.Piece.Queen_W,score:0}),i.push({from:r,to:n[o],data:a.Piece.Rook_W,score:0}),i.push({from:r,to:n[o],data:a.Piece.Bishop_W,score:0}),i.push({from:r,to:n[o],data:a.Piece.Knight_W,score:0})):t==a.Piece.Pawn_B&&7==u?(i.push({from:r,to:n[o],data:a.Piece.Queen_B,score:0}),i.push({from:r,to:n[o],data:a.Piece.Rook_B,score:0}),i.push({from:r,to:n[o],data:a.Piece.Bishop_B,score:0}),i.push({from:r,to:n[o],data:a.Piece.Knight_B,score:0})):i.push({from:r,to:n[o],data:0,score:0})}}}return i},this.finishTurn=()=>{this.whiteTurn=!this.whiteTurn,this.historicalBoards.push(this.createHistoricalBoard()),this.boardHash=this.hashBoard(),this.boardDelta=[],this.allValidMoves=this.getAllValidMoves(),this.savedEvaluations={},this.moveCount++,this.moveRepCount++},this.forceMakeMove=(e,t,i)=>{const s=t.index,r=this.board[e],o=this.board[s];this.boardDelta.push({index:s,piece:o,target:-1}),this.boardDelta.push({index:e,piece:r,target:s}),this.board[s]=this.board[e],this.board[e]=a.Piece.Empty;let n=!1;const h=Math.floor(s/this.boardSize);this.board[s]==a.Piece.Pawn_W&&0==h?(this.board[s]=t.data,this.pieceLocations[a.Piece.Pawn_W].splice(this.pieceLocations[a.Piece.Pawn_W].indexOf(e),1),this.pieceLocations[t.data].push(s),this.boardDelta.push({index:-1,piece:t.data,target:s}),n=!0):this.board[s]==a.Piece.Pawn_B&&7==h&&(this.board[s]=t.data,this.pieceLocations[a.Piece.Pawn_B].splice(this.pieceLocations[a.Piece.Pawn_B].indexOf(e),1),this.pieceLocations[t.data].push(s),this.boardDelta.push({index:-1,piece:t.data,target:s}),n=!0),s==this.enPassantSquare&&(r==a.Piece.Pawn_W?(this.boardDelta.push({index:s+8,piece:a.Piece.Pawn_B,target:-1}),this.board[s+8]=a.Piece.Empty):r==a.Piece.Pawn_B&&(this.boardDelta.push({index:s-8,piece:a.Piece.Pawn_W,target:-1}),this.board[s-8]=a.Piece.Empty)),r==a.Piece.Pawn_W&&e-s==16?(this.enPassantSquare=e-8,this.boardDelta.push({index:-1,piece:a.Piece.Empty,target:-1})):r==a.Piece.Pawn_B&&s-e==16?(this.enPassantSquare=e+8,this.boardDelta.push({index:-1,piece:a.Piece.Empty,target:-1})):this.enPassantSquare=-1,n||this.pieceLocations[r].splice(this.pieceLocations[r].indexOf(e),1,s),o!=a.Piece.Empty&&this.pieceLocations[o].splice(this.pieceLocations[o].indexOf(s),1),i&&(this.finishTurn(),r==a.Piece.Pawn_W||r==a.Piece.Pawn_B||o!=a.Piece.Empty?(this.repetitionHistory=[],this.moveRepCount=0):this.repetitionHistory.push(this.boardHash))},this.unmakeMove=e=>{this.whiteTurn=!this.whiteTurn;for(let t=0;t<e.length;t++){if(e[t].piece!=a.Piece.Empty)if(-1==e[t].index)this.pieceLocations[e[t].piece].splice(this.pieceLocations[e[t].piece].indexOf(e[t].target),1);else if(this.board[e[t].index]!=a.Piece.Empty)this.pieceLocations[e[t].piece].push(e[t].index);else if(-1!=e[t].target){const i=this.pieceLocations[e[t].piece].indexOf(e[t].target);-1!=i?this.pieceLocations[e[t].piece].splice(i,1,e[t].index):this.pieceLocations[e[t].piece].push(e[t].index)}-1!=e[t].index&&(this.board[e[t].index]=e[t].piece)}},this.updateCastleStatus=(e,t)=>{const i=this.board[e];let s=!1;return i==a.Piece.King_W?(this.castleStatus&h.WhiteKing&&62==t?(this.boardDelta.push({index:63,piece:this.board[63],target:61}),this.boardDelta.push({index:61,piece:this.board[61],target:-1}),this.pieceLocations[a.Piece.Rook_W].splice(this.pieceLocations[a.Piece.Rook_W].indexOf(63),1,61),this.board[63]=a.Piece.Empty,this.board[61]=a.Piece.Rook_W,s=!0):this.castleStatus&h.WhiteQueen&&58==t&&(this.boardDelta.push({index:56,piece:this.board[56],target:59}),this.boardDelta.push({index:59,piece:this.board[59],target:-1}),this.pieceLocations[a.Piece.Rook_W].splice(this.pieceLocations[a.Piece.Rook_W].indexOf(56),1,59),this.board[56]=a.Piece.Empty,this.board[59]=a.Piece.Rook_W,s=!0),this.castleStatus&=~h.WhiteKing,this.castleStatus&=~h.WhiteQueen):i==a.Piece.King_B?(this.castleStatus&h.BlackKing&&6==t?(this.boardDelta.push({index:7,piece:this.board[7],target:5}),this.boardDelta.push({index:5,piece:this.board[5],target:-1}),this.pieceLocations[a.Piece.Rook_B].splice(this.pieceLocations[a.Piece.Rook_B].indexOf(7),1,5),this.board[7]=a.Piece.Empty,this.board[5]=a.Piece.Rook_B,s=!0):this.castleStatus&h.BlackQueen&&2==t&&(this.boardDelta.push({index:0,piece:this.board[0],target:3}),this.boardDelta.push({index:3,piece:this.board[3],target:-1}),this.pieceLocations[a.Piece.Rook_B].splice(this.pieceLocations[a.Piece.Rook_B].indexOf(0),1,3),this.board[0]=a.Piece.Empty,this.board[3]=a.Piece.Rook_B,s=!0),this.castleStatus&=~h.BlackKing,this.castleStatus&=~h.BlackQueen):i==a.Piece.Rook_W&&56==e?this.castleStatus&=~h.WhiteQueen:i==a.Piece.Rook_W&&63==e?this.castleStatus&=~h.WhiteKing:i==a.Piece.Rook_B&&0==e?this.castleStatus&=~h.BlackQueen:i==a.Piece.Rook_B&&7==e&&(this.castleStatus&=~h.BlackKing),s},this.updateHash=(e,t,i,s)=>{let r=t;for(let t=0;t<e.length;t++)if(-1!=e[t].index){const i=e[t].index,s=e[t].piece-1,a=this.board[i]-1;s>=0&&(r^=this.zobristHashTable[i][s]),a>=0&&(r^=this.zobristHashTable[i][a])}return(s&h.WhiteKing)!=(this.castleStatus&h.WhiteKing)&&(t^=this.zobristHashTable[64][0]),(s&h.WhiteQueen)!=(this.castleStatus&h.WhiteQueen)&&(t^=this.zobristHashTable[64][1]),(s&h.BlackKing)!=(this.castleStatus&h.BlackKing)&&(t^=this.zobristHashTable[64][2]),(s&h.BlackQueen)!=(this.castleStatus&h.BlackQueen)&&(t^=this.zobristHashTable[64][3]),r^=this.zobristHashTable[65][0],i!=this.enPassantSquare&&(-1!=i&&(r^=this.zobristHashTable[66][i]),-1!=this.enPassantSquare&&(r^=this.zobristHashTable[66][this.enPassantSquare])),r},this.getPieceCount=()=>{let e=0;for(let t=1;t<this.pieceLocations.length;t++)e+=this.pieceLocations[t].length;return e},this.checkForDraw=()=>{if(this.moveRepCount>=50)return!0;if(!this.whiteTurn)return!1;if(2==this.getPieceCount())return!0;let e=0;for(let t=0;t<this.repetitionHistory.length;t++)if(this.repetitionHistory[t]==this.boardHash&&e++,3==e)return!0;return!1},this.predictAndOrderMoves=(e,t)=>{const i=e.length;for(let s=0;s<i;s++){let i=0;const r=this.board[e[s].from],o=this.board[e[s].to],n=e[s].data;if(o!=a.Piece.Empty&&(i=10*this.getPieceValue(o)-this.getPieceValue(r)),t.includes(e[s].to)&&(i-=this.getPieceValue(r)),r==a.Piece.Pawn_W||r==a.Piece.Pawn_B)switch(n){case a.Piece.Knight_W:case a.Piece.Knight_B:i+=this.getPieceValue(a.Piece.Knight_W);break;case a.Piece.Bishop_W:case a.Piece.Bishop_B:i+=this.getPieceValue(a.Piece.Bishop_W);break;case a.Piece.Queen_W:case a.Piece.Queen_B:i+=this.getPieceValue(a.Piece.Queen_W);break;case a.Piece.Rook_W:case a.Piece.Rook_B:i+=this.getPieceValue(a.Piece.Rook_W)}e[s].score=i}e.sort(((e,t)=>t.score-e.score))},this.readSquareTableValue=(e,t,i)=>(i||(e=63-e),t[e]),this.evaluateSquareTable=(e,t,i)=>{let s=0;if(e==a.Piece.Empty)return 0;const r=this.pieceLocations[e],o=r.length;for(let e=0;e<o;e++)s+=this.readSquareTableValue(r[e],t,i);return s},this.evaluateSquareTables=(e,t)=>{let i=0;if(e){i+=this.evaluateSquareTable(a.Piece.Pawn_W,a.pawnSquareTable,e),i+=this.evaluateSquareTable(a.Piece.Rook_W,a.rookSquareTable,e),i+=this.evaluateSquareTable(a.Piece.Knight_W,a.knightSquareTable,e),i+=this.evaluateSquareTable(a.Piece.Bishop_W,a.bishopSquareTable,e),i+=this.evaluateSquareTable(a.Piece.Queen_W,a.queenSquareTable,e);let s=this.evaluateSquareTable(a.Piece.King_W,a.kingMiddleGameSquareTable,e);i+=Math.floor(s*(1-t))}else{i+=this.evaluateSquareTable(a.Piece.Pawn_B,a.pawnSquareTable,e),i+=this.evaluateSquareTable(a.Piece.Rook_B,a.rookSquareTable,e),i+=this.evaluateSquareTable(a.Piece.Knight_B,a.knightSquareTable,e),i+=this.evaluateSquareTable(a.Piece.Bishop_B,a.bishopSquareTable,e),i+=this.evaluateSquareTable(a.Piece.Queen_B,a.queenSquareTable,e);let s=this.evaluateSquareTable(a.Piece.King_B,a.kingMiddleGameSquareTable,e);i+=Math.floor(s*(1-t))}return i},this.evaluateEndgamePosition=(e,t,i,s)=>{let r=0;return r+=Math.abs(t-4)+Math.abs(i-4),r+=14-s,Math.floor(20*r*e)},this.evaluatePawnStructure=e=>{let t=0,i=this.pieceLocations[e?a.Piece.Pawn_W:a.Piece.Pawn_B];const s=i.length;for(let r=0;r<s;r++){(e&&this.board[i[r]+8]==a.Piece.Pawn_W||!e&&this.board[i[r]-8]==a.Piece.Pawn_B)&&(t-=2);const s=e&&this.board[i[r]+7]==a.Piece.Pawn_W||!e&&this.board[i[r]-7]!=a.Piece.Pawn_B,o=e&&this.board[i[r]+9]==a.Piece.Pawn_W||!e&&this.board[i[r]-9]!=a.Piece.Pawn_B;s||o?(o||s)&&(t+=2):t-=2}return 10*t},this.evaluate=()=>{const e=this.countMaterial(!0),t=this.countMaterial(!1),i=e-this.pieceLocations[a.Piece.Pawn_W].length*this.getPieceValue(a.Piece.Pawn_W),s=t-this.pieceLocations[a.Piece.Pawn_B].length*this.getPieceValue(a.Piece.Pawn_B),r=1-Math.min(1,i/this.endgameMaterialThreshold),o=1-Math.min(1,s/this.endgameMaterialThreshold);let n=1*e,h=1*t;n+=Math.floor(1*this.evaluateSquareTables(!0,r)),h+=Math.floor(1*this.evaluateSquareTables(!1,o));const u=this.pieceLocations[a.Piece.King_W][0]%this.boardSize,c=Math.floor(this.pieceLocations[a.Piece.King_W][0]/this.boardSize),l=this.pieceLocations[a.Piece.King_B][0]%this.boardSize,p=Math.floor(this.pieceLocations[a.Piece.King_B][0]/this.boardSize),d=Math.abs(u-l)+Math.abs(c-p);n+=this.evaluateEndgamePosition(r,l,p,d),h+=this.evaluateEndgamePosition(o,u,c,d);let v=n-h;return this.whiteTurn||(v*=-1),v},this.getPieceValue=e=>{switch(e){case a.Piece.Pawn_W:case a.Piece.Pawn_B:return a.Value.Pawn;case a.Piece.Knight_W:case a.Piece.Knight_B:return a.Value.Knight;case a.Piece.Bishop_W:case a.Piece.Bishop_B:return a.Value.Bishop;case a.Piece.Rook_W:case a.Piece.Rook_B:return a.Value.Rook;case a.Piece.Queen_W:case a.Piece.Queen_B:return a.Value.Queen;default:return 0}},this.countMaterial=e=>{let t=0;const i=e?12:6;for(let s=e?8:2;s<=i;s++)t+=this.getPieceValue(s)*this.pieceLocations[s].length;return t},this.findBestMoveWithIterativeDeepening=()=>{this.searchStartTime=Date.now();let e=0;for(let t=3;t<=30&&(self.performance.now(),this.findBestMove(!0,t,0,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),self.performance.now(),!(Date.now()-this.searchStartTime>=this.searchMaxTime))&&(e=t,this.movesFoundThisTurn=this.movesFoundThisIteration,this.movesFoundThisIteration=[],this.evalBestMove=this.evalBestMoveThisIteration,o.postMessage({command:a.EvalCommands.ReceiveCurrentEval,eval:this.whiteTurn?this.evalBestMove.score:-1*this.evalBestMove.score}),!(this.evalBestMoveThisIteration.score>99999999));t++);this.depthSearchedThisTurn=e},this.findBestMove=(e,t,i,s,r)=>{if(e&&Date.now()-this.searchStartTime>=this.searchMaxTime)return 0;if(i>0){if(this.repetitionHistory.includes(this.boardHash))return 0;if((s=Math.max(s,Number.MIN_SAFE_INTEGER+i))>=(r=Math.min(r,Number.MAX_SAFE_INTEGER-i)))return s}const o=this.boardHash.toString();if(o in this.savedEvaluations){const e=this.savedEvaluations[o];let a=e.eval,h=!1;if(e.depth>=t&&(e.type==n.Exact||e.type==n.Alpha&&a<=s||e.type==n.Beta&&a>=r)&&(h=!0),h)return 0==i&&(this.evalBestMoveThisIteration=this.savedEvaluations[o].bestMove,this.evalBestMoveThisIteration.score=this.savedEvaluations[o].eval),a}if(t<=0)return this.quiescenceSearch(s,r);const h=this.getAttackedSquares(this.whiteTurn,-1),u=this.getAllValidMoves(!1,h);if(0==u.length)return this.isInCheckAttackedSquares(this.whiteTurn,h)?Number.MIN_SAFE_INTEGER+i:0;this.predictAndOrderMoves(u,h);const c=this.boardHash,l=this.enPassantSquare,p=this.castleStatus;let d={from:-1,to:-1,data:0,score:0},v=n.Alpha;const f=u.length;for(let h=0;h<f;h++){this.updateCastleStatus(u[h].from,u[h].to),this.forceMakeMove(u[h].from,{index:u[h].to,data:u[h].data},!1);const f=this.boardDelta;this.boardDelta=[],this.whiteTurn=!this.whiteTurn,this.boardHash=this.updateHash(f,c,l,p);let b=-1*this.findBestMove(e,t-1,i+1,-s-1,-s);if(b>s&&b<r&&(b=-1*this.findBestMove(e,t-1,i+1,-r,-s)),this.unmakeMove(f),this.boardHash=c,this.enPassantSquare=l,this.castleStatus=p,b>=r)return this.savedEvaluations[o]={totalMoves:0,depth:t,bestMove:d,type:n.Beta,eval:r},r;b>s&&(d=u[h],s=b,v=n.Exact,0==i&&(this.movesFoundThisIteration.push({from:d.from,to:d.to,data:d.data,piece:this.board[d.from],capture:this.board[d.to]!=a.Piece.Empty,eval:this.whiteTurn?b:-1*b}),this.evalBestMoveThisIteration=d,this.evalBestMoveThisIteration.score=b))}return this.savedEvaluations[o]={totalMoves:0,depth:t,bestMove:d,type:v,eval:s},s},this.calculateAllPossibleMoves=e=>{if(e<=0)return 1;const t=this.boardHash.toString();if(t in this.savedEvaluations&&this.savedEvaluations[t].depth==e)return this.savedEvaluations[t].totalMoves;const i=this.getAllValidMoves();let s=0;const r=this.boardHash,a=this.enPassantSquare,o=this.castleStatus,h=i.length;for(let t=0;t<h;t++){this.updateCastleStatus(i[t].from,i[t].to),this.forceMakeMove(i[t].from,{index:i[t].to,data:i[t].data},!1);const n=this.boardDelta;this.boardDelta=[],this.whiteTurn=!this.whiteTurn,this.boardHash=this.updateHash(n,r,a,o),s+=this.calculateAllPossibleMoves(e-1),this.unmakeMove(n),this.boardHash=r,this.enPassantSquare=a,this.castleStatus=o}return this.savedEvaluations[t]={totalMoves:s,depth:e,eval:0,type:n.Exact,bestMove:{from:-1,to:-1,data:0,score:0}},s},this.randomBotMove=()=>{if(0!=this.historicalIndex)return;const e=Math.floor(Math.random()*this.allValidMoves.length),t=this.allValidMoves[e];this.updateCastleStatus(t.from,t.to),this.forceMakeMove(t.from,{index:t.to,data:t.data},!0)},this.evalBotMove=e=>{if(0!=this.historicalIndex)return;if(this.checkForDraw())return;const t=self.performance.now();this.movesFoundThisIteration=[],this.movesFoundThisTurn=[];const i=this.evalBestMove;if(this.findBestMove(!1,e,0,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),i.to==this.evalBestMoveThisIteration.to&&i.from==this.evalBestMoveThisIteration.from)return void console.log("Attempting to make the same move: "+i.toString());this.evalBestMove=this.evalBestMoveThisIteration,this.movesFoundThisTurn=this.movesFoundThisIteration,this.depthSearchedThisTurn=e,this.castledThisTurn=this.updateCastleStatus(this.evalBestMove.from,this.evalBestMove.to),this.pieceCapturedThisTurn=this.board[this.evalBestMove.to]!=a.Piece.Empty,this.forceMakeMove(this.evalBestMove.from,{index:this.evalBestMove.to,data:this.evalBestMove.data},!0);const s=self.performance.now();this.timeTakenLastTurn=s-t},this.evalBotMoveIterative=()=>{if(0!=this.historicalIndex)return;if(this.checkForDraw())return;const e=self.performance.now();this.movesFoundThisIteration=[],this.movesFoundThisTurn=[];const t=Object.assign({},this.evalBestMove);if(c.findBestMoveWithIterativeDeepening(),t.to==this.evalBestMove.to&&t.from==this.evalBestMove.from)return void console.log("Attempting to make the same move: "+t.toString());this.castledThisTurn=this.updateCastleStatus(this.evalBestMove.from,this.evalBestMove.to),this.pieceCapturedThisTurn=this.board[this.evalBestMove.to]!=a.Piece.Empty,this.forceMakeMove(this.evalBestMove.from,{index:this.evalBestMove.to,data:this.evalBestMove.data},!0);const i=self.performance.now();this.timeTakenLastTurn=i-e},this.attemptMove=(e,t)=>{const i=this.board[e];return 0==this.historicalIndex&&(!this.checkForDraw()&&(e!=t&&i!=a.Piece.Empty&&(!(this.whiteTurn&&i<a.Piece.King_W||!this.whiteTurn&&i>a.Piece.Pawn_B)&&(!!this.getAllValidMoves().some((i=>i.from==e&&i.to==t))&&(this.castledThisTurn=this.updateCastleStatus(e,t),this.pieceCapturedThisTurn=this.board[t]!=a.Piece.Empty,this.forceMakeMove(e,{index:t,data:this.whiteTurn?a.Piece.Queen_W:a.Piece.Queen_B},!0),!0)))))},this.board=[];const e=r.default(2).pow(64).minus(1);for(let t=0;t<64;t++){this.zobristHashTable.push([]);for(let i=0;i<12;i++)this.zobristHashTable[t].push(BigInt(r.default.randBetween(0,e)))}let t=[];for(let i=0;i<4;i++)t.push(BigInt(r.default.randBetween(0,e)));this.zobristHashTable.push(t),this.zobristHashTable.push([BigInt(r.default.randBetween(0,e))]);let i=[];for(let t=0;t<64;t++)i.push(BigInt(r.default.randBetween(0,e)));this.zobristHashTable.push(i),this.board=this.parseFEN("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"),this.boardHash=this.hashBoard(),this.repetitionHistory.push(this.boardHash),this.historicalBoards.push(this.createHistoricalBoard()),this.allValidMoves=this.getAllValidMoves()}quiescenceSearch(e,t){let i=this.evaluate();if(i>=t)return t;i>e&&(e=i);const s=this.getAttackedSquares(this.whiteTurn,-1),r=this.getAllValidMoves(!0,s);this.predictAndOrderMoves(r,s);const a=this.enPassantSquare,o=r.length;for(let s=0;s<o;s++){this.forceMakeMove(r[s].from,{index:r[s].to,data:r[s].data},!1);const o=this.boardDelta;if(this.boardDelta=[],this.whiteTurn=!this.whiteTurn,i=-1*this.quiescenceSearch(-t,-e),this.unmakeMove(o),this.enPassantSquare=a,i>=t)return t;i>e&&(e=i)}return e}}t.Engine=u;const c=new u;o.addEventListener("message",(e=>{switch(e.data.command){case a.EngineCommands.RetrieveBoard:o.postMessage({command:e.data.command,board:c.board,validMoves:c.allValidMoves});break;case a.EngineCommands.AttemptMove:{const t=c.attemptMove(e.data.fromIndex,e.data.toIndex),i=!!t&&c.isInCheck(c.whiteTurn);o.postMessage({command:e.data.command,from:e.data.fromIndex,to:e.data.toIndex,whiteTurn:c.whiteTurn,board:t?c.historicalBoards[c.historicalBoards.length-1]:void 0,validMoves:c.allValidMoves,inCheck:i,captured:c.pieceCapturedThisTurn,castled:c.castledThisTurn,draw:c.checkForDraw()});break}case a.EngineCommands.HistoryGoBack:{c.stepBack();const t=c.historicalBoards.length-1+c.historicalIndex;o.postMessage({command:e.data.command,board:c.historicalBoards[t],index:t});break}case a.EngineCommands.HistoryGoForward:{c.stepForward();const t=c.historicalBoards.length-1+c.historicalIndex;o.postMessage({command:e.data.command,board:c.historicalBoards[t],index:t});break}case a.EngineCommands.UndoMove:if(0==c.historicalIndex){c.undoMove();const t=c.historicalBoards.length-1;o.postMessage({command:e.data.command,board:c.historicalBoards[t],index:t})}break;case a.EngineCommands.BotBestMove:{c.evalBotMove(6);const t=c.isInCheck(c.whiteTurn);o.postMessage({command:e.data.command,from:c.evalBestMove.from,to:c.evalBestMove.to,timeTaken:c.timeTakenLastTurn,depthSearched:c.depthSearchedThisTurn,movesFound:c.movesFoundThisTurn,whiteTurn:c.whiteTurn,board:c.historicalBoards[c.historicalBoards.length-1],validMoves:c.allValidMoves,inCheck:t,captured:c.pieceCapturedThisTurn,castled:c.castledThisTurn,draw:c.checkForDraw()});break}case a.EngineCommands.BotBestMoveIterative:{c.evalBotMoveIterative();const t=c.isInCheck(c.whiteTurn);o.postMessage({command:e.data.command,from:c.evalBestMove.from,to:c.evalBestMove.to,timeTaken:c.timeTakenLastTurn,depthSearched:c.depthSearchedThisTurn,movesFound:c.movesFoundThisTurn,whiteTurn:c.whiteTurn,board:c.historicalBoards[c.historicalBoards.length-1],validMoves:c.allValidMoves,inCheck:t,captured:c.pieceCapturedThisTurn,castled:c.castledThisTurn,draw:c.checkForDraw()});break}case a.EngineCommands.RetrievePieceLocations:o.postMessage({command:e.data.command,locations:c.pieceLocations})}}))},736:(e,t,i)=>{var s;e=i.nmd(e);var r=function(e){"use strict";var t=1e7,i=9007199254740992,s=p(i),a="0123456789abcdefghijklmnopqrstuvwxyz",o="function"==typeof BigInt;function n(e,t,i,s){return void 0===e?n[0]:void 0===t||10==+t&&!i?J(e):D(e,t,i,s)}function h(e,t){this.value=e,this.sign=t,this.isSmall=!1}function u(e){this.value=e,this.sign=e<0,this.isSmall=!0}function c(e){this.value=e}function l(e){return-i<e&&e<i}function p(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function d(e){v(e);var i=e.length;if(i<4&&W(e,s)<0)switch(i){case 0:return 0;case 1:return e[0];case 2:return e[0]+e[1]*t;default:return e[0]+(e[1]+e[2]*t)*t}return e}function v(e){for(var t=e.length;0===e[--t];);e.length=t+1}function f(e){for(var t=new Array(e),i=-1;++i<e;)t[i]=0;return t}function b(e){return e>0?Math.floor(e):Math.ceil(e)}function g(e,i){var s,r,a=e.length,o=i.length,n=new Array(a),h=0,u=t;for(r=0;r<o;r++)h=(s=e[r]+i[r]+h)>=u?1:0,n[r]=s-h*u;for(;r<a;)h=(s=e[r]+h)===u?1:0,n[r++]=s-h*u;return h>0&&n.push(h),n}function m(e,t){return e.length>=t.length?g(e,t):g(t,e)}function y(e,i){var s,r,a=e.length,o=new Array(a),n=t;for(r=0;r<a;r++)s=e[r]-n+i,i=Math.floor(s/n),o[r]=s-i*n,i+=1;for(;i>0;)o[r++]=i%n,i=Math.floor(i/n);return o}function P(e,i){var s,r,a=e.length,o=i.length,n=new Array(a),h=0,u=t;for(s=0;s<o;s++)(r=e[s]-h-i[s])<0?(r+=u,h=1):h=0,n[s]=r;for(s=o;s<a;s++){if(!((r=e[s]-h)<0)){n[s++]=r;break}r+=u,n[s]=r}for(;s<a;s++)n[s]=e[s];return v(n),n}function B(e,i,s){var r,a,o=e.length,n=new Array(o),c=-i,l=t;for(r=0;r<o;r++)a=e[r]+c,c=Math.floor(a/l),a%=l,n[r]=a<0?a+l:a;return"number"==typeof(n=d(n))?(s&&(n=-n),new u(n)):new h(n,s)}function S(e,i){var s,r,a,o,n=e.length,h=i.length,u=f(n+h),c=t;for(a=0;a<n;++a){o=e[a];for(var l=0;l<h;++l)s=o*i[l]+u[a+l],r=Math.floor(s/c),u[a+l]=s-r*c,u[a+l+1]+=r}return v(u),u}function w(e,i){var s,r,a=e.length,o=new Array(a),n=t,h=0;for(r=0;r<a;r++)s=e[r]*i+h,h=Math.floor(s/n),o[r]=s-h*n;for(;h>0;)o[r++]=h%n,h=Math.floor(h/n);return o}function T(e,t){for(var i=[];t-- >0;)i.push(0);return i.concat(e)}function M(e,t){var i=Math.max(e.length,t.length);if(i<=30)return S(e,t);i=Math.ceil(i/2);var s=e.slice(i),r=e.slice(0,i),a=t.slice(i),o=t.slice(0,i),n=M(r,o),h=M(s,a),u=M(m(r,s),m(o,a)),c=m(m(n,T(P(P(u,n),h),i)),T(h,2*i));return v(c),c}function _(e,i,s){return new h(e<t?w(i,e):S(i,p(e)),s)}function k(e){var i,s,r,a,o=e.length,n=f(o+o),h=t;for(r=0;r<o;r++){s=0-(a=e[r])*a;for(var u=r;u<o;u++)i=a*e[u]*2+n[r+u]+s,s=Math.floor(i/h),n[r+u]=i-s*h;n[r+o]=s}return v(n),n}function E(e,t){var i,s,r,a,o=e.length,n=f(o);for(r=0,i=o-1;i>=0;--i)r=(a=1e7*r+e[i])-(s=b(a/t))*t,n[i]=0|s;return[n,0|r]}function q(e,i){var s,r=J(i);if(o)return[new c(e.value/r.value),new c(e.value%r.value)];var a,l=e.value,g=r.value;if(0===g)throw new Error("Cannot divide by zero");if(e.isSmall)return r.isSmall?[new u(b(l/g)),new u(l%g)]:[n[0],e];if(r.isSmall){if(1===g)return[e,n[0]];if(-1==g)return[e.negate(),n[0]];var m=Math.abs(g);if(m<t){a=d((s=E(l,m))[0]);var y=s[1];return e.sign&&(y=-y),"number"==typeof a?(e.sign!==r.sign&&(a=-a),[new u(a),new u(y)]):[new h(a,e.sign!==r.sign),new u(y)]}g=p(m)}var B=W(l,g);if(-1===B)return[n[0],e];if(0===B)return[n[e.sign===r.sign?1:-1],n[0]];a=(s=l.length+g.length<=200?function(e,i){var s,r,a,o,n,h,u,c=e.length,l=i.length,p=t,v=f(i.length),b=i[l-1],g=Math.ceil(p/(2*b)),m=w(e,g),y=w(i,g);for(m.length<=c&&m.push(0),y.push(0),b=y[l-1],r=c-l;r>=0;r--){for(s=p-1,m[r+l]!==b&&(s=Math.floor((m[r+l]*p+m[r+l-1])/b)),a=0,o=0,h=y.length,n=0;n<h;n++)a+=s*y[n],u=Math.floor(a/p),o+=m[r+n]-(a-u*p),a=u,o<0?(m[r+n]=o+p,o=-1):(m[r+n]=o,o=0);for(;0!==o;){for(s-=1,a=0,n=0;n<h;n++)(a+=m[r+n]-p+y[n])<0?(m[r+n]=a+p,a=0):(m[r+n]=a,a=1);o+=a}v[r]=s}return m=E(m,g)[0],[d(v),d(m)]}(l,g):function(e,i){for(var s,r,a,o,n,h=e.length,u=i.length,c=[],l=[],p=t;h;)if(l.unshift(e[--h]),v(l),W(l,i)<0)c.push(0);else{a=l[(r=l.length)-1]*p+l[r-2],o=i[u-1]*p+i[u-2],r>u&&(a=(a+1)*p),s=Math.ceil(a/o);do{if(W(n=w(i,s),l)<=0)break;s--}while(s);c.push(s),l=P(l,n)}return c.reverse(),[d(c),d(l)]}(l,g))[0];var S=e.sign!==r.sign,T=s[1],M=e.sign;return"number"==typeof a?(S&&(a=-a),a=new u(a)):a=new h(a,S),"number"==typeof T?(M&&(T=-T),T=new u(T)):T=new h(T,M),[a,T]}function W(e,t){if(e.length!==t.length)return e.length>t.length?1:-1;for(var i=e.length-1;i>=0;i--)if(e[i]!==t[i])return e[i]>t[i]?1:-1;return 0}function I(e){var t=e.abs();return!t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(49)||void 0))}function x(e,t){for(var i,s,a,o=e.prev(),n=o,h=0;n.isEven();)n=n.divide(2),h++;e:for(s=0;s<t.length;s++)if(!e.lesser(t[s])&&!(a=r(t[s]).modPow(n,e)).isUnit()&&!a.equals(o)){for(i=h-1;0!=i;i--){if((a=a.square().mod(e)).isUnit())return!1;if(a.equals(o))continue e}return!1}return!0}h.prototype=Object.create(n.prototype),u.prototype=Object.create(n.prototype),c.prototype=Object.create(n.prototype),h.prototype.add=function(e){var t=J(e);if(this.sign!==t.sign)return this.subtract(t.negate());var i=this.value,s=t.value;return t.isSmall?new h(y(i,Math.abs(s)),this.sign):new h(m(i,s),this.sign)},h.prototype.plus=h.prototype.add,u.prototype.add=function(e){var t=J(e),i=this.value;if(i<0!==t.sign)return this.subtract(t.negate());var s=t.value;if(t.isSmall){if(l(i+s))return new u(i+s);s=p(Math.abs(s))}return new h(y(s,Math.abs(i)),i<0)},u.prototype.plus=u.prototype.add,c.prototype.add=function(e){return new c(this.value+J(e).value)},c.prototype.plus=c.prototype.add,h.prototype.subtract=function(e){var t=J(e);if(this.sign!==t.sign)return this.add(t.negate());var i=this.value,s=t.value;return t.isSmall?B(i,Math.abs(s),this.sign):function(e,t,i){var s;return W(e,t)>=0?s=P(e,t):(s=P(t,e),i=!i),"number"==typeof(s=d(s))?(i&&(s=-s),new u(s)):new h(s,i)}(i,s,this.sign)},h.prototype.minus=h.prototype.subtract,u.prototype.subtract=function(e){var t=J(e),i=this.value;if(i<0!==t.sign)return this.add(t.negate());var s=t.value;return t.isSmall?new u(i-s):B(s,Math.abs(i),i>=0)},u.prototype.minus=u.prototype.subtract,c.prototype.subtract=function(e){return new c(this.value-J(e).value)},c.prototype.minus=c.prototype.subtract,h.prototype.negate=function(){return new h(this.value,!this.sign)},u.prototype.negate=function(){var e=this.sign,t=new u(-this.value);return t.sign=!e,t},c.prototype.negate=function(){return new c(-this.value)},h.prototype.abs=function(){return new h(this.value,!1)},u.prototype.abs=function(){return new u(Math.abs(this.value))},c.prototype.abs=function(){return new c(this.value>=0?this.value:-this.value)},h.prototype.multiply=function(e){var i,s,r,a=J(e),o=this.value,u=a.value,c=this.sign!==a.sign;if(a.isSmall){if(0===u)return n[0];if(1===u)return this;if(-1===u)return this.negate();if((i=Math.abs(u))<t)return new h(w(o,i),c);u=p(i)}return new h(-.012*(s=o.length)-.012*(r=u.length)+15e-6*s*r>0?M(o,u):S(o,u),c)},h.prototype.times=h.prototype.multiply,u.prototype._multiplyBySmall=function(e){return l(e.value*this.value)?new u(e.value*this.value):_(Math.abs(e.value),p(Math.abs(this.value)),this.sign!==e.sign)},h.prototype._multiplyBySmall=function(e){return 0===e.value?n[0]:1===e.value?this:-1===e.value?this.negate():_(Math.abs(e.value),this.value,this.sign!==e.sign)},u.prototype.multiply=function(e){return J(e)._multiplyBySmall(this)},u.prototype.times=u.prototype.multiply,c.prototype.multiply=function(e){return new c(this.value*J(e).value)},c.prototype.times=c.prototype.multiply,h.prototype.square=function(){return new h(k(this.value),!1)},u.prototype.square=function(){var e=this.value*this.value;return l(e)?new u(e):new h(k(p(Math.abs(this.value))),!1)},c.prototype.square=function(e){return new c(this.value*this.value)},h.prototype.divmod=function(e){var t=q(this,e);return{quotient:t[0],remainder:t[1]}},c.prototype.divmod=u.prototype.divmod=h.prototype.divmod,h.prototype.divide=function(e){return q(this,e)[0]},c.prototype.over=c.prototype.divide=function(e){return new c(this.value/J(e).value)},u.prototype.over=u.prototype.divide=h.prototype.over=h.prototype.divide,h.prototype.mod=function(e){return q(this,e)[1]},c.prototype.mod=c.prototype.remainder=function(e){return new c(this.value%J(e).value)},u.prototype.remainder=u.prototype.mod=h.prototype.remainder=h.prototype.mod,h.prototype.pow=function(e){var t,i,s,r=J(e),a=this.value,o=r.value;if(0===o)return n[1];if(0===a)return n[0];if(1===a)return n[1];if(-1===a)return r.isEven()?n[1]:n[-1];if(r.sign)return n[0];if(!r.isSmall)throw new Error("The exponent "+r.toString()+" is too large.");if(this.isSmall&&l(t=Math.pow(a,o)))return new u(b(t));for(i=this,s=n[1];!0&o&&(s=s.times(i),--o),0!==o;)o/=2,i=i.square();return s},u.prototype.pow=h.prototype.pow,c.prototype.pow=function(e){var t=J(e),i=this.value,s=t.value,r=BigInt(0),a=BigInt(1),o=BigInt(2);if(s===r)return n[1];if(i===r)return n[0];if(i===a)return n[1];if(i===BigInt(-1))return t.isEven()?n[1]:n[-1];if(t.isNegative())return new c(r);for(var h=this,u=n[1];(s&a)===a&&(u=u.times(h),--s),s!==r;)s/=o,h=h.square();return u},h.prototype.modPow=function(e,t){if(e=J(e),(t=J(t)).isZero())throw new Error("Cannot take modPow with modulus 0");var i=n[1],s=this.mod(t);for(e.isNegative()&&(e=e.multiply(n[-1]),s=s.modInv(t));e.isPositive();){if(s.isZero())return n[0];e.isOdd()&&(i=i.multiply(s).mod(t)),e=e.divide(2),s=s.square().mod(t)}return i},c.prototype.modPow=u.prototype.modPow=h.prototype.modPow,h.prototype.compareAbs=function(e){var t=J(e),i=this.value,s=t.value;return t.isSmall?1:W(i,s)},u.prototype.compareAbs=function(e){var t=J(e),i=Math.abs(this.value),s=t.value;return t.isSmall?i===(s=Math.abs(s))?0:i>s?1:-1:-1},c.prototype.compareAbs=function(e){var t=this.value,i=J(e).value;return(t=t>=0?t:-t)===(i=i>=0?i:-i)?0:t>i?1:-1},h.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=J(e),i=this.value,s=t.value;return this.sign!==t.sign?t.sign?1:-1:t.isSmall?this.sign?-1:1:W(i,s)*(this.sign?-1:1)},h.prototype.compareTo=h.prototype.compare,u.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=J(e),i=this.value,s=t.value;return t.isSmall?i==s?0:i>s?1:-1:i<0!==t.sign?i<0?-1:1:i<0?1:-1},u.prototype.compareTo=u.prototype.compare,c.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=this.value,i=J(e).value;return t===i?0:t>i?1:-1},c.prototype.compareTo=c.prototype.compare,h.prototype.equals=function(e){return 0===this.compare(e)},c.prototype.eq=c.prototype.equals=u.prototype.eq=u.prototype.equals=h.prototype.eq=h.prototype.equals,h.prototype.notEquals=function(e){return 0!==this.compare(e)},c.prototype.neq=c.prototype.notEquals=u.prototype.neq=u.prototype.notEquals=h.prototype.neq=h.prototype.notEquals,h.prototype.greater=function(e){return this.compare(e)>0},c.prototype.gt=c.prototype.greater=u.prototype.gt=u.prototype.greater=h.prototype.gt=h.prototype.greater,h.prototype.lesser=function(e){return this.compare(e)<0},c.prototype.lt=c.prototype.lesser=u.prototype.lt=u.prototype.lesser=h.prototype.lt=h.prototype.lesser,h.prototype.greaterOrEquals=function(e){return this.compare(e)>=0},c.prototype.geq=c.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals=h.prototype.geq=h.prototype.greaterOrEquals,h.prototype.lesserOrEquals=function(e){return this.compare(e)<=0},c.prototype.leq=c.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals=h.prototype.leq=h.prototype.lesserOrEquals,h.prototype.isEven=function(){return 0==(1&this.value[0])},u.prototype.isEven=function(){return 0==(1&this.value)},c.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},h.prototype.isOdd=function(){return 1==(1&this.value[0])},u.prototype.isOdd=function(){return 1==(1&this.value)},c.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},h.prototype.isPositive=function(){return!this.sign},u.prototype.isPositive=function(){return this.value>0},c.prototype.isPositive=u.prototype.isPositive,h.prototype.isNegative=function(){return this.sign},u.prototype.isNegative=function(){return this.value<0},c.prototype.isNegative=u.prototype.isNegative,h.prototype.isUnit=function(){return!1},u.prototype.isUnit=function(){return 1===Math.abs(this.value)},c.prototype.isUnit=function(){return this.abs().value===BigInt(1)},h.prototype.isZero=function(){return!1},u.prototype.isZero=function(){return 0===this.value},c.prototype.isZero=function(){return this.value===BigInt(0)},h.prototype.isDivisibleBy=function(e){var t=J(e);return!t.isZero()&&(!!t.isUnit()||(0===t.compareAbs(2)?this.isEven():this.mod(t).isZero()))},c.prototype.isDivisibleBy=u.prototype.isDivisibleBy=h.prototype.isDivisibleBy,h.prototype.isPrime=function(t){var i=I(this);if(i!==e)return i;var s=this.abs(),a=s.bitLength();if(a<=64)return x(s,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*a.toJSNumber(),n=Math.ceil(!0===t?2*Math.pow(o,2):o),h=[],u=0;u<n;u++)h.push(r(u+2));return x(s,h)},c.prototype.isPrime=u.prototype.isPrime=h.prototype.isPrime,h.prototype.isProbablePrime=function(t,i){var s=I(this);if(s!==e)return s;for(var a=this.abs(),o=t===e?5:t,n=[],h=0;h<o;h++)n.push(r.randBetween(2,a.minus(2),i));return x(a,n)},c.prototype.isProbablePrime=u.prototype.isProbablePrime=h.prototype.isProbablePrime,h.prototype.modInv=function(e){for(var t,i,s,a=r.zero,o=r.one,n=J(e),h=this.abs();!h.isZero();)t=n.divide(h),i=a,s=n,a=o,n=h,o=i.subtract(t.multiply(o)),h=s.subtract(t.multiply(h));if(!n.isUnit())throw new Error(this.toString()+" and "+e.toString()+" are not co-prime");return-1===a.compare(0)&&(a=a.add(e)),this.isNegative()?a.negate():a},c.prototype.modInv=u.prototype.modInv=h.prototype.modInv,h.prototype.next=function(){var e=this.value;return this.sign?B(e,1,this.sign):new h(y(e,1),this.sign)},u.prototype.next=function(){var e=this.value;return e+1<i?new u(e+1):new h(s,!1)},c.prototype.next=function(){return new c(this.value+BigInt(1))},h.prototype.prev=function(){var e=this.value;return this.sign?new h(y(e,1),!0):B(e,1,this.sign)},u.prototype.prev=function(){var e=this.value;return e-1>-i?new u(e-1):new h(s,!0)},c.prototype.prev=function(){return new c(this.value-BigInt(1))};for(var K=[1];2*K[K.length-1]<=t;)K.push(2*K[K.length-1]);var R=K.length,C=K[R-1];function N(e){return Math.abs(e)<=t}function L(e,t,i){t=J(t);for(var s=e.isNegative(),a=t.isNegative(),o=s?e.not():e,n=a?t.not():t,h=0,u=0,c=null,l=null,p=[];!o.isZero()||!n.isZero();)h=(c=q(o,C))[1].toJSNumber(),s&&(h=C-1-h),u=(l=q(n,C))[1].toJSNumber(),a&&(u=C-1-u),o=c[0],n=l[0],p.push(i(h,u));for(var d=0!==i(s?1:0,a?1:0)?r(-1):r(0),v=p.length-1;v>=0;v-=1)d=d.multiply(C).add(r(p[v]));return d}h.prototype.shiftLeft=function(e){var t=J(e).toJSNumber();if(!N(t))throw new Error(String(t)+" is too large for shifting.");if(t<0)return this.shiftRight(-t);var i=this;if(i.isZero())return i;for(;t>=R;)i=i.multiply(C),t-=R-1;return i.multiply(K[t])},c.prototype.shiftLeft=u.prototype.shiftLeft=h.prototype.shiftLeft,h.prototype.shiftRight=function(e){var t,i=J(e).toJSNumber();if(!N(i))throw new Error(String(i)+" is too large for shifting.");if(i<0)return this.shiftLeft(-i);for(var s=this;i>=R;){if(s.isZero()||s.isNegative()&&s.isUnit())return s;s=(t=q(s,C))[1].isNegative()?t[0].prev():t[0],i-=R-1}return(t=q(s,K[i]))[1].isNegative()?t[0].prev():t[0]},c.prototype.shiftRight=u.prototype.shiftRight=h.prototype.shiftRight,h.prototype.not=function(){return this.negate().prev()},c.prototype.not=u.prototype.not=h.prototype.not,h.prototype.and=function(e){return L(this,e,(function(e,t){return e&t}))},c.prototype.and=u.prototype.and=h.prototype.and,h.prototype.or=function(e){return L(this,e,(function(e,t){return e|t}))},c.prototype.or=u.prototype.or=h.prototype.or,h.prototype.xor=function(e){return L(this,e,(function(e,t){return e^t}))},c.prototype.xor=u.prototype.xor=h.prototype.xor;var V=1<<30;function A(e){var i=e.value,s="number"==typeof i?i|V:"bigint"==typeof i?i|BigInt(V):i[0]+i[1]*t|1073758208;return s&-s}function H(e,t){if(t.compareTo(e)<=0){var i=H(e,t.square(t)),s=i.p,a=i.e,o=s.multiply(t);return o.compareTo(e)<=0?{p:o,e:2*a+1}:{p:s,e:2*a}}return{p:r(1),e:0}}function z(e,t){return e=J(e),t=J(t),e.greater(t)?e:t}function Q(e,t){return e=J(e),t=J(t),e.lesser(t)?e:t}function O(e,t){if(e=J(e).abs(),t=J(t).abs(),e.equals(t))return e;if(e.isZero())return t;if(t.isZero())return e;for(var i,s,r=n[1];e.isEven()&&t.isEven();)i=Q(A(e),A(t)),e=e.divide(i),t=t.divide(i),r=r.multiply(i);for(;e.isEven();)e=e.divide(A(e));do{for(;t.isEven();)t=t.divide(A(t));e.greater(t)&&(s=t,t=e,e=s),t=t.subtract(e)}while(!t.isZero());return r.isUnit()?e:e.multiply(r)}h.prototype.bitLength=function(){var e=this;return e.compareTo(r(0))<0&&(e=e.negate().subtract(r(1))),0===e.compareTo(r(0))?r(0):r(H(e,r(2)).e).add(r(1))},c.prototype.bitLength=u.prototype.bitLength=h.prototype.bitLength;var D=function(e,t,i,s){i=i||a,e=String(e),s||(e=e.toLowerCase(),i=i.toLowerCase());var r,o=e.length,n=Math.abs(t),h={};for(r=0;r<i.length;r++)h[i[r]]=r;for(r=0;r<o;r++)if("-"!==(l=e[r])&&l in h&&h[l]>=n){if("1"===l&&1===n)continue;throw new Error(l+" is not a valid digit in base "+t+".")}t=J(t);var u=[],c="-"===e[0];for(r=c?1:0;r<e.length;r++){var l;if((l=e[r])in h)u.push(J(h[l]));else{if("<"!==l)throw new Error(l+" is not a valid character");var p=r;do{r++}while(">"!==e[r]&&r<e.length);u.push(J(e.slice(p+1,r)))}}return F(u,t,c)};function F(e,t,i){var s,r=n[0],a=n[1];for(s=e.length-1;s>=0;s--)r=r.add(e[s].times(a)),a=a.times(t);return i?r.negate():r}function G(e,t){if((t=r(t)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(t.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var i=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return i.unshift([1]),{value:[].concat.apply([],i),isNegative:!1}}var s=!1;if(e.isNegative()&&t.isPositive()&&(s=!0,e=e.abs()),t.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:s};for(var a,o=[],n=e;n.isNegative()||n.compareAbs(t)>=0;){a=n.divmod(t),n=a.quotient;var h=a.remainder;h.isNegative()&&(h=t.minus(h).abs(),n=n.next()),o.push(h.toJSNumber())}return o.push(n.toJSNumber()),{value:o.reverse(),isNegative:s}}function Z(e,t,i){var s=G(e,t);return(s.isNegative?"-":"")+s.value.map((function(e){return function(e,t){return e<(t=t||a).length?t[e]:"<"+e+">"}(e,i)})).join("")}function U(e){if(l(+e)){var t=+e;if(t===b(t))return o?new c(BigInt(t)):new u(t);throw new Error("Invalid integer: "+e)}var i="-"===e[0];i&&(e=e.slice(1));var s=e.split(/e/i);if(s.length>2)throw new Error("Invalid integer: "+s.join("e"));if(2===s.length){var r=s[1];if("+"===r[0]&&(r=r.slice(1)),(r=+r)!==b(r)||!l(r))throw new Error("Invalid integer: "+r+" is not a valid exponent.");var a=s[0],n=a.indexOf(".");if(n>=0&&(r-=a.length-n-1,a=a.slice(0,n)+a.slice(n+1)),r<0)throw new Error("Cannot include negative exponent part for integers");e=a+=new Array(r+1).join("0")}if(!/^([0-9][0-9]*)$/.test(e))throw new Error("Invalid integer: "+e);if(o)return new c(BigInt(i?"-"+e:e));for(var p=[],d=e.length,f=d-7;d>0;)p.push(+e.slice(f,d)),(f-=7)<0&&(f=0),d-=7;return v(p),new h(p,i)}function J(e){return"number"==typeof e?function(e){if(o)return new c(BigInt(e));if(l(e)){if(e!==b(e))throw new Error(e+" is not an integer.");return new u(e)}return U(e.toString())}(e):"string"==typeof e?U(e):"bigint"==typeof e?new c(e):e}h.prototype.toArray=function(e){return G(this,e)},u.prototype.toArray=function(e){return G(this,e)},c.prototype.toArray=function(e){return G(this,e)},h.prototype.toString=function(t,i){if(t===e&&(t=10),10!==t)return Z(this,t,i);for(var s,r=this.value,a=r.length,o=String(r[--a]);--a>=0;)s=String(r[a]),o+="0000000".slice(s.length)+s;return(this.sign?"-":"")+o},u.prototype.toString=function(t,i){return t===e&&(t=10),10!=t?Z(this,t,i):String(this.value)},c.prototype.toString=u.prototype.toString,c.prototype.toJSON=h.prototype.toJSON=u.prototype.toJSON=function(){return this.toString()},h.prototype.valueOf=function(){return parseInt(this.toString(),10)},h.prototype.toJSNumber=h.prototype.valueOf,u.prototype.valueOf=function(){return this.value},u.prototype.toJSNumber=u.prototype.valueOf,c.prototype.valueOf=c.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var j=0;j<1e3;j++)n[j]=J(j),j>0&&(n[-j]=J(-j));return n.one=n[1],n.zero=n[0],n.minusOne=n[-1],n.max=z,n.min=Q,n.gcd=O,n.lcm=function(e,t){return e=J(e).abs(),t=J(t).abs(),e.divide(O(e,t)).multiply(t)},n.isInstance=function(e){return e instanceof h||e instanceof u||e instanceof c},n.randBetween=function(e,i,s){e=J(e),i=J(i);var r=s||Math.random,a=Q(e,i),o=z(e,i).subtract(a).add(1);if(o.isSmall)return a.add(Math.floor(r()*o));for(var h=G(o,t).value,u=[],c=!0,l=0;l<h.length;l++){var p=c?h[l]:t,d=b(r()*p);u.push(d),d<p&&(c=!1)}return a.add(n.fromArray(u,t,!1))},n.fromArray=function(e,t,i){return F(e.map(J),J(t||10),i)},n}();e.hasOwnProperty("exports")&&(e.exports=r),void 0===(s=function(){return r}.call(t,i,t,e))||(e.exports=s)}},t={};function i(s){var r=t[s];if(void 0!==r)return r.exports;var a=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),i(212)})();
//# sourceMappingURL=engine.bundle.worker.js.map